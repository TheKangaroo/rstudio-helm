
{{ include "rstudio-connect.fullname" . }} successfully deployed to namespace {{ $.Release.Namespace }}

{{- /* Verify configuration values */ -}}
{{- if hasKey .Values "config" }}

{{- if hasKey .Values.config "Licensing" }}
{{- if hasKey .Values.config.Licensing "LicenseType" }}

NOTE: `.Values.config.Licensing.LicenseType` is configured manually. Normally, we automatically configure this value:
  - When `license.server` is set, we set `LicenseType` to `remote`.
  - Otherwise, `LicenseType` uses the default of `local`.
Please consider removing this configuration value.

{{- end }}
{{- end }}

{{- if hasKey .Values.config "Launcher" }}
{{- if hasKey .Values.config.Launcher "DataDir" }}
{{- if contains ":" .Values.config.Launcher.DataDir }}

NOTE: `config.Launcher.DataDir` is configured with a ":". When a ":" character
is found, Connect treats this configuration as an NFS connection string. Connect then
uses this information to create NFS volumes when mounting the DataDir to the content
pods created by the Launcher. This feature will be removed in the next release of Connect.
  - Please consider setting `sharedStorage.mountContent = true` instead.
  - When `sharedStorage.mountContent = true`, `config.Launcher.DataDir`
    should not be set.

{{- end }}
{{- end }}
{{- end }}

{{- end }}

{{- /* chart deprecations and misconfiguration warnings */ -}}

{{- if and .Values.launcher.useTemplates .Values.launcher.enabled }}
  {{- range $k,$v :=  .Values.launcher.launcherKubernetesProfilesConf }}
    {{- if hasKey $v "job-json-overrides" }}
      {{- fail "\n\n`launcher.launcherKubernetesProfilesConf` has `job-json-overrides` defined. This cannot be used with `launcher.useTemplates=true`.\n\nPlease move `job-json-overrides` to the corresponding `launcher.templateValues`, or set `launcher.useTemplates=false`" }}
    {{- end }}
  {{- end }}
{{- end }}

{{- if .Values.launcher.contentInitContainer }}
  {{- fail "\n\n`launcher.contentInitContainer` values are now stored at `launcher.defaultInitContainer`" }}
{{- end }}
